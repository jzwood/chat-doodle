"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function controller(t){function e(){t.width=l,t.height=f,d.lineWidth=8,d.lineCap="round"}function n(t){return t.touches?[t.touches[0].clientX,t.touches[0].clientY]:[t.clientX,t.clientY]}function r(t){m.isDrawing=!0;var e=n(t),r=_slicedToArray(e,2),o=r[0],i=r[1];m.x1=parseFloat(o.toFixed(v)),m.y1=parseFloat(i.toFixed(v)),m.x2=parseFloat(o.toFixed(v)),m.y2=parseFloat(i.toFixed(v))}function o(t){var e=n(t),r=_slicedToArray(e,2),o=r[0],i=r[1];m.x2=parseFloat(o.toFixed(v)),m.y2=parseFloat(i.toFixed(v))}function i(t){m.isDrawing=!1}function a(t){l=window.innerWidth,f=window.innerHeight,e(),resetNav(),y.forEach(function(t){u.apply(void 0,_toConsumableArray(t.split(",").map(function(t){return parseInt(t)})))})}function c(){s(),socket.emit("clear",h,0)}function u(t,e,n,r){d.fillStyle=w,d.beginPath(),d.moveTo(t,e),d.lineTo(n,r),d.closePath(),d.stroke()}function s(){d.clearRect(0,0,l,f),y.clear()}var d=t.getContext("2d"),l=window.innerWidth,f=window.innerHeight,v=0,y=new Set,h=void 0,m={x1:0,y1:0,x2:0,y2:0,isDrawing:!1,step:function(){this.x1=this.x2,this.y1=this.y2}},p="#ffffff",w="#000000";return e(),function(){document.addEventListener("touchstart",r),document.addEventListener("touchmove",o),document.addEventListener("touchend",i),document.addEventListener("mousedown",r),document.addEventListener("mousemove",o),document.addEventListener("mouseup",i),window.addEventListener("resize",debounce(a,100));var t=document.querySelector(".btn__refresh");t.addEventListener("touchend",c),t.addEventListener("mouseup",c)}(),{line:u,clearBackground:s,setRoom:function(t){h=t},setBackground:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#ffffff";p=t,d.fillStyle=p,d.fillRect(0,0,l,f),d.fillStyle=t},draw:function(){if(m.isDrawing){var t=m,e=[t.x1,t.y1,t.x2,t.y2].join(",");y.has(e)||(socket.emit("pushData",h,{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),u(t.x1,t.y1,t.x2,t.y2),y.add(e),t.step())}}}}function resetNav(){var t=document.querySelector(".nav");t.style.height=Math.min(50,~~(window.innerWidth/t.childElementCount))+"px"}function start(){var t=document.querySelector(".canvas-wrapper__canvas");if(t.getContext){var e=controller(t);e.setBackground("#ffffff"),resetNav(),socket=io("/");var n=window.location.pathname.slice(-40);e.setRoom(n),socket.emit("init",n),socket.on("linePositionData",function(t){e.line(t.x1,t.y1,t.x2,t.y2)}),socket.on("clear",function(){e.clearBackground()}),MainLoop.setMaxAllowedFPS([60]).setDraw(e.draw).start()}}function avg(t){return t.reduce(function(t,e){return t+e},0)/t.length}function mod(t,e){for(var n=t%e;n<=0;)n+=e;return n}function throttle(t,e){var n=arguments,r=this,o=0;return function(){var i=n,a=r,c=+new Date;c>=o+e&&(o=c,t.apply(a,i))}}function debounce(t,e,n){var r=this,o=arguments,i=void 0;return function(){var a=r,c=o,u=function(){i=null,n||t.apply(a,c)},s=n&&!i;clearTimeout(i),i=setTimeout(u,e),s&&t.apply(a,c)}}var _slicedToArray=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),io,socket;document.addEventListener("DOMContentLoaded",function(t){start()});
//# sourceMappingURL=main.js.map

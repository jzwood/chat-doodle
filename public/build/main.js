"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function controller(e){function t(){e.width=m,e.height=p,h.lineWidth=8,h.lineCap="round"}function n(e){return e.touches?[e.touches[0].clientX,e.touches[0].clientY]:[e.clientX,e.clientY]}function o(e){_.isDrawing=!0;var t=n(e),o=_slicedToArray(t,2),r=o[0],a=o[1];_.x1=parseFloat(r.toFixed(y)),_.y1=parseFloat(a.toFixed(y)),_.x2=parseFloat(r.toFixed(y)),_.y2=parseFloat(a.toFixed(y))}function r(e){e.preventDefault();var t=n(e),o=_slicedToArray(t,2),r=o[0],a=o[1];_.x2=parseFloat(r.toFixed(y)),_.y2=parseFloat(a.toFixed(y))}function a(e){_.isDrawing=!1}function i(e){m=window.innerWidth,p=window.innerHeight,t(),v.forEach(function(e){l.apply(void 0,_toConsumableArray(e.split(",").map(function(e){return parseInt(e)})))})}function u(){f(),socket.emit("clear",x)}function c(){h.clearRect(0,0,m,p),v=v.slice(0,-2).map(function(e){return l.apply(void 0,_toConsumableArray(e.split(",").map(function(e){return parseInt(e)}))),e})}function s(){g.show()}function d(){w.show()}function l(e,t,n,o){h.fillStyle=E,h.beginPath(),h.moveTo(e,t),h.lineTo(n,o),h.stroke()}function f(){h.clearRect(0,0,m,p),v.length=0}var h=e.getContext("2d"),m=window.innerWidth,p=window.innerHeight,y=0,v=[],g=getShareModal(),w=getAboutModal(),b=!1;g.onShow(function(){b=!0}),w.onShow(function(){b=!0}),g.onHide(function(){window.setTimeout(function(){b=!1},200)}),w.onHide(function(){window.setTimeout(function(){b=!1},200)});var x=void 0,_={x1:0,y1:0,x2:0,y2:0,isDrawing:!1,isErasing:!1,step:function(){this.x1=this.x2,this.y1=this.y2}},L="#ffffff",E="#000000";return t(),function(){document.addEventListener("touchstart",o),document.addEventListener("touchmove",r),document.addEventListener("touchend",a),document.addEventListener("mousedown",o),document.addEventListener("mousemove",r),document.addEventListener("mouseup",a),window.addEventListener("resize",debounce(i,100));var e=document.querySelector(".btn__refresh");e.addEventListener("touchend",u),e.addEventListener("mouseup",u);var t=document.querySelector(".btn__erase");t.addEventListener("touchend",c),t.addEventListener("mouseup",c);var n=document.querySelector(".btn__share");n.addEventListener("touchend",s),n.addEventListener("mouseup",s);var l=document.querySelector(".btn__about");l.addEventListener("touchend",d),l.addEventListener("mouseup",d)}(),{line:l,clearBackground:f,setRoom:function(e){x=e},setBackground:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#ffffff";L=e,h.fillStyle=L,h.fillRect(0,0,m,p),h.fillStyle=e},draw:function(){if(_.isDrawing&&!b){var e=_,t=[e.x1,e.y1,e.x2,e.y2].join(",");v.slice(-1)[0]!==t&&(socket.emit("pushData",x,{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),l(e.x1,e.y1,e.x2,e.y2),v.push(t),e.step())}}}}function start(){var e=document.querySelector(".canvas-wrapper__canvas");if(e.getContext){var t=controller(e);t.setBackground("#ffffff"),socket=io("/");var n=window.location.pathname.slice(-40);t.setRoom(n),socket.emit("init",n),socket.on("linePositionData",function(e){t.line(e.x1,e.y1,e.x2,e.y2)}),socket.on("clear",t.clearBackground),MainLoop.setMaxAllowedFPS([60]).setDraw(t.draw).start()}}function getShareModal(){var e=window.location.href;return nanoModal('\n    Anyone who goes to<br>\n    <input id="copyURL" size="'+e.length+'" value="'+e+'"></input><br>\n    will join this real-time doodle.\n    ',{overlayClose:!1,classes:"shareModal",buttons:[{text:"Copy URL to clipboard",handler:function(e){document.getElementById("copyURL").select(),document.execCommand("copy"),document.querySelector(".nanoModalBtnPrimary").innerText="Copied"},primary:!0},{text:"Cancel",handler:"hide"}]})}function getAboutModal(){return nanoModal('\n    Icons from the <a href="https://thenounproject.com/" target="_blank">Noun Project</a>.<br>\n    <u><a href="https://thenounproject.com/term/share/1020875/" target="_blank">Share</a></u> and <u><a href="https://thenounproject.com/term/refresh/1020876/" target="_blank">refresh</a></u> icon created by <a href="https://thenounproject.com/pundimon/" target="_blank">Pundimon</a>.<br>\n    <u><a href="https://thenounproject.com/term/erasing/1005575/" target="_blank">Erase</a></u> icon modified from icon created by <a href="https://thenounproject.com/madeleine.bennett/" target="_blank">Madeleine Bennett</a>.<br>\n    All icons used under the <a href="https://creativecommons.org/licenses/by/3.0/us/legalcode" target="_blank">Creative Commons</a> License.\n    ',{overlayClose:!1,classes:"aboutModal",buttons:[{text:"Close",handler:"hide",primary:!0}]})}function avg(e){return e.reduce(function(e,t){return e+t},0)/e.length}function mod(e,t){for(var n=e%t;n<=0;)n+=t;return n}function throttle(e,t){var n=arguments,o=this,r=0;return function(){var a=n,i=o,u=+new Date;u>=r+t&&(r=u,e.apply(i,a))}}function debounce(e,t,n){var o=this,r=arguments,a=void 0;return function(){var i=o,u=r,c=function(){a=null,n||e.apply(i,u)},s=n&&!a;clearTimeout(a),a=setTimeout(c,t),s&&e.apply(i,u)}}var _slicedToArray=function(){function e(e,t){var n=[],o=!0,r=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(o=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),io,socket;document.addEventListener("DOMContentLoaded",function(e){start()});
//# sourceMappingURL=main.js.map

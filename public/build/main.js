function newController(n,t){var e=newUser(),o=newAnimator(n,t);return{onEnter:function(n,t,o){13===o&&(e.readInput(),n.emit("clientDataPush",t,e.getRule()))},update:function(n){o.setState(n)},animate:function(){o.draw()}}}function newAnimator(n,t){var e=[],o=["#000000","#ff00ff","#00ffff","#00ff00","#ffff00","#ff0000"],r=0,a=0;return{draw:function(){for(var n=0,i=e.length;n<i;n++)t.fill(o[e[n]]),t.rect(a*(n%r),a*~~(n/r),a,a)},setState:function(t){e=t.slice(0),r=Math.sqrt(e.length),a=n/r}}}function newUser(){function n(n){var t=n.split("/").map(function(n){return n.trim()}).join("/");return t}var t=[],e={textContent:"123/3"};return{readInput:function(){t.push(n(e.textContent))},getRule:function(){var n=t.slice(-1).toString();return n.length?n:"/"}}}function app(n){function t(){var t=location.href.indexOf("/private");socket=io(t>0?"/private":"/public");var e=window.location.pathname.slice(-40);n.stroke("#363636"),n.strokeWeight(1),n.strokeCap(n.SQUARE),socket.emit("init",e),socket.on("updateBoard",function(n){o.update(n)}),addKeyPressListener(socket,e,o.onEnter)}var e=500,o=newController(e,n);n.setup=function(){var o=n.createCanvas(e+1,e+1);o.parent("wrapper__canvas"),o.class("wrapper__canvas__p5"),console.log("waiting for network connection");var r=window.setInterval(function(){console.count("connection attempts"),io&&(console.log("network connected"),t(),window.clearInterval(r))},100)},n.draw=function(){n.background("#cccccc"),o.animate()}}function addKeyPressListener(n,t,e){var o=500;document.addEventListener("keydown",function(r){r.preventDefault(),throttle(e(n,t,r.keyCode),o)},!1)}function throttle(n,t){var e=0;return function(){var o=arguments,r=this,a=+new Date;a>=e+t&&(e=a,n.apply(r,o))}}var io,socket,p5App=new window.p5(app);
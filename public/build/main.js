function newController(n,e){var t=newUser(),r=newAnimator(n,e);return{onEnter:function(n,e,r){13===r&&(t.readInput(),n.emit("clientDataPush",e,t.getRule()))},update:function(n){r.setState(n)},animate:function(){r.draw()}}}function newAnimator(n,e){var t=[],r=["#000000","#ff00ff","#00ffff","#00ff00","#ffff00","#ff0000"],o=0,a=0;return{draw:function(){for(var n=0,c=t.length;n<c;n++)e.fill(r[t[n]]),e.rect(a*(n%o),a*~~(n/o),a,a)},setState:function(e){t=e.slice(0),o=Math.sqrt(t.length),a=n/o}}}function newUser(){function n(n){var e=n.split("/").map(function(n){return n.trim()}).join("/");return e}var e=[],t=document.querySelector(".wrapper__terminal");return{readInput:function(){e.push(n(t.value))},getRule:function(){var n=e.slice(-1).toString();return n.length?n:"/"}}}function app(n){function e(){var e=location.href.indexOf("/private");socket=io(e>0?"/private":"/public");var t=window.location.pathname.slice(-40);n.noStroke(),n.stroke("#111111"),n.strokeWeight(1),n.strokeCap(n.SQUARE),socket.emit("init",t),socket.on("updateBoard",function(n){r.update(n)}),socket.on("removeInputfield",function(n){document.querySelector(".wrapper__terminal").remove(),document.querySelector(".warning").textContent=n}),addKeyPressListener(socket,t,r.onEnter)}var t=500,r=newController(t,n);n.setup=function(){var r=n.createCanvas(t+1,t+1);r.parent("wrapper__canvas"),r.class("wrapper__canvas__p5"),console.log("waiting for network connection");var o=window.setInterval(function(){console.count("connection attempts"),io&&(console.log("network connected"),e(),window.clearInterval(o))},100)},n.draw=function(){n.background("#cccccc"),r.animate()}}function addKeyPressListener(n,e,t){var r=500;document.addEventListener("keydown",function(o){throttle(t(n,e,o.keyCode),r)},!1)}function throttle(n,e){var t=0;return function(){var r=arguments,o=this,a=+new Date;a>=t+e&&(t=a,n.apply(o,r))}}var io,socket,p5App=new window.p5(app);
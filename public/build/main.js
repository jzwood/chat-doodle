"use strict";function GET_ITER$0(e){if(e){if(Array.isArray(e))return 0;var t;if(S_MARK$0&&S_MARK$0(e),"object"==typeof e&&"function"==typeof(t=e[S_ITER$0]))return S_MARK$0&&S_MARK$0(void 0),t.call(e);if(S_MARK$0&&S_MARK$0(void 0),e+""=="[object Generator]")return e}throw new Error(e+" is not iterable")}function setup(){canvasWidth=640,canvasHeight=480;createCanvas(canvasWidth,canvasHeight).parent("sketch-container");frameRate(10),fleet=new Map}function draw(){var e,t,o,n;background("#ECEEFB"),n=fleet.values(),e=GET_ITER$0(n),o=0===e,t=o?n.length:void 0;for(var i;o?e<t:!(t=e.next()).done;)i=o?n[e++]:t.value,i.update();e=t=o=n=void 0}function initShip(e,t){console.log("////////////////////////////////////////////////////////");var o=socket.id===e?"#009E60":"#FF9E9E",n=newShip(e,o);n.setProps(t),fleet.set(e,n)}function updateShip(e,t){console.log("========================================================");var o=fleet.get(e);o.setProps(t)}function newShip(e,t){var o={},n=0,i=0,a=2,r=0,c=15,s=function(){fill(t);var e=3*Math.PI/4;quad(n+.75*c*Math.cos(r),i+.75*c*Math.sin(r),n+c*Math.cos(r-e),i+c*Math.sin(r-e),n-.5*c*Math.cos(r),i-.5*c*Math.sin(r),n+c*Math.cos(r+e),i+c*Math.sin(r+e))};return o.getProps=function(){return{x:n,y:i,r:r}},o.setProps=function(e){n=e.x,i=e.y,r=e.r},o.update=function(){n=mod(n+a*Math.cos(r),canvasWidth),i=mod(i+a*Math.sin(r),canvasHeight),s()},o}function mod(e,t){for(var o=e%t;o<0;)o+=t;return o}function initSocketListener(e){console.log("initSocketListener"),initSocketListener=Function(""),socket.on(e.disconnect,function(e){console.log("deleted",e,"from client map"),fleet.delete(e)});window.setInterval(function(){socket.emit(e.update,fleet.get(socket.id).getProps())},100)}var S_ITER$0="undefined"!=typeof Symbol&&Symbol&&Symbol.iterator||"@@iterator",S_MARK$0="undefined"!=typeof Symbol&&Symbol&&Symbol.__setObjectSetter__,canvasWidth=void 0,canvasHeight=void 0,createCanvas=void 0,background=void 0,frameRate=void 0,fill=void 0,quad=void 0,fleet=void 0,io,socket=function(){var e=location.href.indexOf("/private");return io(e>0?"/private":"/public")}();socket.on("init",function(e){var t,o,n,i=e.map,a=Object.keys(i);t=GET_ITER$0(a),n=0===t,o=n?a.length:void 0;for(var r;n?t<o:!(o=t.next()).done;)r=n?a[t++]:o.value,console.log(e.map,fleet),fleet.has(r)?updateShip(r,i[r]):initShip(r,i[r]);t=o=n=void 0,initSocketListener(e.ids),console.log(fleet,e.map)});
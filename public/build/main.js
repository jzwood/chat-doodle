"use strict";function newController(n,t){var e=newUser(),r=newAnimator(n,t);return{onEnter:function(n,t,r){13===r&&(e.readInput(),n.emit("clientDataPush",t,e.getRule()))},update:function(n){r.setState(n)},animate:function(){r.draw()}}}function newAnimator(n,t){var e=[],r=["#000000","#ff00ff","#00ffff","#00ff00","#ffff00","#ff0000"],o=0,a=0;return{draw:function(){for(var n=0,c=e.length;n<c;n++)t.fill(r[e[n]]),t.rect(a*(n%o),a*~~(n/o),a,a)},setState:function(t){e=t.slice(0),o=Math.sqrt(e.length),a=n/o}}}function newUser(){function n(n){var t=n.split("/").map(function(n){return n.trim()}).join("/");return t}var t=[],e=document.querySelector(".wrapper__terminal");return{readInput:function(){t.push(n(e.value))},getRule:function(){var n=t.slice(-1).toString();return n.length?n:"/"}}}function app(n){function t(){var t=location.href.indexOf("/private");socket=io(t>0?"/private":"/public");var e=window.location.pathname.slice(-40);n.noStroke(),n.stroke("#111111"),n.strokeWeight(1),n.strokeCap(n.SQUARE),socket.emit("init",e),socket.on("updateBoard",function(n){r.update(n)}),socket.on("removeInputfield",function(n){document.querySelector(".wrapper__terminal").remove(),document.querySelector(".warning").textContent=n}),addKeyPressListener(socket,e,r.onEnter)}var e=500,r=newController(e,n);n.setup=function(){var r=n.createCanvas(e+1,e+1);r.parent("wrapper__canvas"),r.class("wrapper__canvas__p5"),console.log("waiting for network connection");var o=window.setInterval(function(){console.count("connection attempts"),io&&(console.log("network connected"),t(),window.clearInterval(o))},100)},n.draw=function(){n.background("#cccccc"),r.animate()}}function addKeyPressListener(n,t,e){var r=500;document.addEventListener("keydown",function(o){throttle(e(n,t,o.keyCode),r)},!1)}function throttle(n,t){var e=0;return function(){var r=arguments,o=this,a=+new Date;a>=e+t&&(e=a,n.apply(o,r))}}var io,socket,p5App=new window.p5(app);
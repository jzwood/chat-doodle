"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function controller(t){function e(){t.width=f,t.height=y,l.lineWidth=8,l.lineCap="round"}function n(t){return t.touches?[t.touches[0].clientX,t.touches[0].clientY]:[t.clientX,t.clientY]}function r(t){m.isDrawing=!0;var e=n(t),r=_slicedToArray(e,2),o=r[0],i=r[1];m.x1=parseFloat(o.toFixed(v)),m.y1=parseFloat(i.toFixed(v)),m.x2=parseFloat(o.toFixed(v)),m.y2=parseFloat(i.toFixed(v))}function o(t){var e=n(t),r=_slicedToArray(e,2),o=r[0],i=r[1];m.x2=parseFloat(o.toFixed(v)),m.y2=parseFloat(i.toFixed(v))}function i(t){m.isDrawing=!1}function a(t){f=window.innerWidth,y=window.innerHeight,e(),h.forEach(function(t){s.apply(void 0,_toConsumableArray(t.split(",").map(function(t){return parseInt(t)})))})}function c(){d(),socket.emit("clear",p)}function u(){l.clearRect(0,0,f,y),h=h.slice(0,-2).map(function(t){return s.apply(void 0,_toConsumableArray(t.split(",").map(function(t){return parseInt(t)}))),t})}function s(t,e,n,r){l.fillStyle=x,l.beginPath(),l.moveTo(t,e),l.lineTo(n,r),l.closePath(),l.stroke()}function d(){l.clearRect(0,0,f,y),h.length=0}var l=t.getContext("2d"),f=window.innerWidth,y=window.innerHeight,v=0,h=[],p=void 0,m={x1:0,y1:0,x2:0,y2:0,isDrawing:!1,isErasing:!1,step:function(){this.x1=this.x2,this.y1=this.y2}},w="#ffffff",x="#000000";return e(),function(){document.addEventListener("touchstart",r),document.addEventListener("touchmove",o),document.addEventListener("touchend",i),document.addEventListener("mousedown",r),document.addEventListener("mousemove",o),document.addEventListener("mouseup",i),window.addEventListener("resize",debounce(a,100));var t=document.querySelector(".btn__refresh");t.addEventListener("touchend",c),t.addEventListener("mouseup",c);var e=document.querySelector(".btn__erase");e.addEventListener("touchend",u),e.addEventListener("mouseup",u)}(),{line:s,clearBackground:d,setRoom:function(t){p=t},setBackground:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#ffffff";w=t,l.fillStyle=w,l.fillRect(0,0,f,y),l.fillStyle=t},draw:function(){if(m.isDrawing){var t=m,e=[t.x1,t.y1,t.x2,t.y2].join(",");h.slice(-1)[0]!==e&&(socket.emit("pushData",p,{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),s(t.x1,t.y1,t.x2,t.y2),h.push(e),t.step())}}}}function start(){var t=document.querySelector(".canvas-wrapper__canvas");if(t.getContext){var e=controller(t);e.setBackground("#ffffff"),socket=io("/");var n=window.location.pathname.slice(-40);e.setRoom(n),socket.emit("init",n),socket.on("linePositionData",function(t){e.line(t.x1,t.y1,t.x2,t.y2)}),socket.on("clear",e.clearBackground),MainLoop.setMaxAllowedFPS([60]).setDraw(e.draw).start()}}function avg(t){return t.reduce(function(t,e){return t+e},0)/t.length}function mod(t,e){for(var n=t%e;n<=0;)n+=e;return n}function throttle(t,e){var n=arguments,r=this,o=0;return function(){var i=n,a=r,c=+new Date;c>=o+e&&(o=c,t.apply(a,i))}}function debounce(t,e,n){var r=this,o=arguments,i=void 0;return function(){var a=r,c=o,u=function(){i=null,n||t.apply(a,c)},s=n&&!i;clearTimeout(i),i=setTimeout(u,e),s&&t.apply(a,c)}}var _slicedToArray=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),io,socket;document.addEventListener("DOMContentLoaded",function(t){start()});
//# sourceMappingURL=main.js.map

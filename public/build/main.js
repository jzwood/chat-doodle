"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function controller(e){function t(){e.width=y,e.height=v,f.lineWidth=8,f.lineCap="round"}function n(e){return e.touches?[e.touches[0].clientX,e.touches[0].clientY]:[e.clientX,e.clientY]}function o(e){x.isDrawing=!0;var t=n(e),o=_slicedToArray(t,2),r=o[0],i=o[1];x.x1=parseFloat(r.toFixed(h)),x.y1=parseFloat(i.toFixed(h)),x.x2=parseFloat(r.toFixed(h)),x.y2=parseFloat(i.toFixed(h))}function r(e){var t=n(e),o=_slicedToArray(t,2),r=o[0],i=o[1];x.x2=parseFloat(r.toFixed(h)),x.y2=parseFloat(i.toFixed(h))}function i(e){x.isDrawing=!1}function a(e){y=window.innerWidth,v=window.innerHeight,t(),m.forEach(function(e){l.apply(void 0,_toConsumableArray(e.split(",").map(function(e){return parseInt(e)})))})}function c(){s(),socket.emit("clear",w)}function u(){f.clearRect(0,0,y,v),m=m.slice(0,-2).map(function(e){return l.apply(void 0,_toConsumableArray(e.split(",").map(function(e){return parseInt(e)}))),e})}function d(e){e.preventDefault(),p.show()}function l(e,t,n,o){f.fillStyle=L,f.beginPath(),f.moveTo(e,t),f.lineTo(n,o),f.closePath(),f.stroke()}function s(){f.clearRect(0,0,y,v),m.length=0}var f=e.getContext("2d"),y=window.innerWidth,v=window.innerHeight,h=0,m=[],p=getModal();window.modal=p;var w=void 0,x={x1:0,y1:0,x2:0,y2:0,isDrawing:!1,isErasing:!1,step:function(){this.x1=this.x2,this.y1=this.y2}},g="#ffffff",L="#000000";return t(),function(){document.addEventListener("touchstart",o),document.addEventListener("touchmove",r),document.addEventListener("touchend",i),document.addEventListener("mousedown",o),document.addEventListener("mousemove",r),document.addEventListener("mouseup",i),window.addEventListener("resize",debounce(a,100));var e=document.querySelector(".btn__refresh");e.addEventListener("touchend",c),e.addEventListener("mouseup",c);var t=document.querySelector(".btn__erase");t.addEventListener("touchend",u),t.addEventListener("mouseup",u);var n=document.querySelector(".btn__share");n.addEventListener("touchend",d),n.addEventListener("mouseup",d)}(),{line:l,clearBackground:s,setRoom:function(e){w=e},setBackground:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#ffffff";g=e,f.fillStyle=g,f.fillRect(0,0,y,v),f.fillStyle=e},draw:function(){if(x.isDrawing){var e=x,t=[e.x1,e.y1,e.x2,e.y2].join(",");m.slice(-1)[0]!==t&&(socket.emit("pushData",w,{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),l(e.x1,e.y1,e.x2,e.y2),m.push(t),e.step())}}}}function start(){var e=document.querySelector(".canvas-wrapper__canvas");if(e.getContext){var t=controller(e);t.setBackground("#ffffff"),socket=io("/");var n=window.location.pathname.slice(-40);t.setRoom(n),socket.emit("init",n),socket.on("linePositionData",function(e){t.line(e.x1,e.y1,e.x2,e.y2)}),socket.on("clear",t.clearBackground),MainLoop.setMaxAllowedFPS([60]).setDraw(t.draw).start()}}function getModal(){var e=window.location.href;return nanoModal('\n    Anyone who goes to<br>\n    <input id="copyURL" size="'+e.length+'" value="'+e+'"></input><br>\n    will join this real-time doodle.\n    ',{overlayClose:!1,buttons:[{text:"Copy URL to clipboard",handler:function(e){document.getElementById("copyURL").select(),document.execCommand("copy"),document.querySelector(".nanoModalBtnPrimary").innerText="Copied"},primary:!0},{text:"Cancel",handler:"hide"}]})}function avg(e){return e.reduce(function(e,t){return e+t},0)/e.length}function mod(e,t){for(var n=e%t;n<=0;)n+=t;return n}function throttle(e,t){var n=arguments,o=this,r=0;return function(){var i=n,a=o,c=+new Date;c>=r+t&&(r=c,e.apply(a,i))}}function debounce(e,t,n){var o=this,r=arguments,i=void 0;return function(){var a=o,c=r,u=function(){i=null,n||e.apply(a,c)},d=n&&!i;clearTimeout(i),i=setTimeout(u,t),d&&e.apply(a,c)}}var _slicedToArray=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&c.return&&c.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),io,socket;document.addEventListener("DOMContentLoaded",function(e){start()});
//# sourceMappingURL=main.js.map
